# Proxy Pattern

- 특정 객체에 접근을 조절하기 위하여 대리자(프록시)를 세움
- 필요할 때만 비싼 대가의 기능을 접근하도록 프록시를 사이에 두는 것!

시간이 많이 소요되는 불필요한 복잡한 객체를 생성하는 시간을 

간단한 객체인 프록시로 줄인다.

문서를 보고자 할 때의 예시로 문서 전체를 불러오면 오래 걸리니 

일단 사용자가 보고 있는 부분만 실제 객체를 불러오고 

아직 보지 않은 부분에 대해서는 프록시만 불러오는 것

<img width="447" alt="image" src="https://user-images.githubusercontent.com/57888020/172088103-f012987c-1dd1-4389-8951-b713d0e0941d.png">

프록시 객체가 처음 생성될 때는 자신이 대신할 image 객체를 미리 만들지 않고

외부에서 처음 요청이 들어왔을 때(image 객체가 필요할 때) image 객체를 생성

## 의도
특정 객체에 대한 접근(access)를 조절하기 위해 대리자를 둔다.

## 별명
Surrogate(대리)

클래스 다이어그램
<img width="443" alt="image" src="https://user-images.githubusercontent.com/57888020/172088186-de858f2c-cc5f-4e6e-a992-d48f65aa2f5d.png">

일반적인 구조
<img width="403" alt="image" src="https://user-images.githubusercontent.com/57888020/172088257-e501ee28-abd1-4605-89c1-7b309c9da3a8.png">

## 구성요소

### Proxy(ImageProxy)

- RealSubject : 객체에 대한 레퍼런스 유지
- Subject Interface를 구현하여 RealSubject 객체를 대신할 수 있음
- RealSubject 객체에 대한 접근은 조절하며, 해당 객체에 대한 생성과 소멸을 책임질 수도

### Subject(Graphic)

- RealSubject와 Proxy의 공통 인터페이스를 정의한다.

### RealSubject(Image)

- Proxy가 대신할 실제 객체를 정의함

## 협동

- 프록시는 클라이언트의 요청을 RealSubject 객체에게 보낸다.

## 프록시 종류

- 리모트 프록시
  
  다른 공간(주소)에 존재하는 객체에 대한 로컬 표현
  
- 가상 프록시
  
  복잡한 객체를 필요로할 때
  
- 보호 프록시

  원래 객체에 대한 엑세스 권한 제한
  
- 스마트 레퍼런스
  
  객체 접근 시 추가적인 액션 수행
  
  참조 회수를 관리하거나 객체를 수정할 수 없도록 로킹

## 패턴 적용 결과

- 투명성 : 리모트 프록시는 객체가 다른 주소 공간에 존재하는 사실을 숨길 수 있게 함
- 최적화 : 가상 프록시는 객체를 필요시에만 생성하여 최적화, 불필요한 다운로드 또는 heavy work를 피한다.
- 보호 프록시와 스마트 레퍼런스는 객체가 접근할 때 추가적인 housekeeping 작업을 수행

## 프록시패턴 장점

- 사이즈가 큰 객체가 로딩되기 전에도 프록시를 통해 참조를 할 수 있다.
- 실제 객체의 public, protected 메소드를 숨기고 인터페이스를 통해 노출시킬 수 있다.
- 로컬에 있지 않고 떨어져있는 객체를 사용할 수 있다.
- 원래 객체에 접근에 대해 사전처리를 할 수 있다.

## 프록시패턴 단점

- 객체를 생성할 때 한 단계를 거치게 되므로, 빈번한 객체 생성이 필요한 경우 성능이 저하될 수 있다.
- 프록시 내부에서 객체 생성을 위해 스레드가 생성, 동기화가 구현되어야 하는 경우 성능이 저하될 수 있다.
- 로직이 난해해져 가독성이 떨어질 수 있다.
